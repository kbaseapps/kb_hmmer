#
# define display information
#
name: HMMsearch for MSA (prot-prot) - v3.3.1
tooltip: |
    Search for matches to a Multiple Sequence Alignment (MSA) using Hidden Markov Model Search (hmmsearch).
screenshots:

    - HMMER_output_table.png

icon: hmmer-cyan.png

#
# define a set of similar methods that might be useful to the user
#
suggestions:
    apps:
        related:
            []
        next:
            []
    methods:
        related:
            []
        next:
            []

#
# Configure the display and description of parameters
#
parameters :
    input_msa_ref:
        ui-name : |
            Query MSA
        short-hint : |
            May use a multiple protein sequence alignment generated by hmmbuild to use as the query sequence.
    input_many_ref:
        ui-name : |
            Targets Object
        short-hint : |
            PROTEIN Targets object to be searched.  Data types may be FeatureSet, Genome, GenomeSet, or AnnotatedMetagenomeAssembly.
    genome_disp_name_config:
        ui-name : |
            Display genome as
        short-hint : |
            Use the object name, object version, and/or scientific name of the Genome in the function profile report
    output_filtered_name:
        ui-name : |
            Output FeatureSet name
        short-hint : |
            The FeatureSet object containing matches.
    e_value:
        ui-name : |
            E-value
        short-hint : |
            The expect-value threshold for true hits.
    bitscore:
        ui-name : |
            Bit Score
        short-hint : |
            The bit score threshold for true hits.
    model_cov_perc:
        ui-name : |
            Model coverage minimum(%)
        short-hint : |
            The minimum coverage of the model length for a given hit.
    maxaccepts:
        ui-name : |
            Max Accepts
        short-hint : |
            Limits the number of hits in the result (default is 1000).

description : |
    <p>This App performs a Hidden Markov Model (HMM) search (hmmsearch) on protein sequences using HMMER models build from an input Multiple Sequence Alignment (MSA).</p>

    <p>This App turns a protein multiple sequence alignment (MSA) into a Hidden Markov Model (HMM) which is used to search a protein sequence database. The MSA must first be generated using a tool such as MUSCLE to build an MSA from a FeatureSet object. The KBase implementation permits searching through the genes in a Genome object, the genes in the Genome members of a GenomeSet, or the genes in a FeatureSet. The output object of these searches is a FeatureSet containing those genes that pass the thresholds given by the user. The App also provides a table of hits (with those hits that are below the thresholds in gray) and links to download the table of hits and a Stockholm format MSA.</p>

    <p><b>Configuration:</b></p>
    <p><b><i>Query MSA:</i></b> The MSA to use as the query.  It must be generated using an alignment App such as MUSCLE. An HMM will be automatically generated from the MSA by hmmbuild.</p>
    <p><b><i>Targets Object:</i></b> The Targets object may be a FeatureSet of genes, a Genome, or a GenomeSet. An HMMER search database will be automatically generated from the Targets object.</p>
    <p><b><i>Output Object:</i></b> This is the set of genes that hits within the user-defined thresholds.</p>
    <p><b><i>E-value:</i></b> This bounds the e-value for the weakest hit to consider viable. Values below this do not get reported in the table or the HMMER output text downloads.</p>
    <p><b><i>Bitscore:</i></b> This bounds the bit score for the weakest hit to include in the FeatureSet output object. Hits below this threshold are still reported in the table and HMMER text downloads.</p>
    <p><b><i>Max Accepts:</i></b> Limit on the number of hits to report (default is 1000).</p>

    <p><b>Output:</b></p>
    <p><b><i>Output Object:</i></b> Gene hits are captured in a FeatureSet output object. If there are additional user-defined thresholds, those are filtered out and do not appear in the object, even if they are shown in the output table.</p>
    <p><b><i>Output HTML Table:</i></b> The tab-delimited hit table is HTML-formatted and shows the region of the hit sequence (as there is no query sequence) covered by the HMMER alignment. Hits that are above the e-value threshold but below other thresholds and are not included in the FeatureSet output object are shown in gray, with the attributes that were below the threshold in red.</p>
    <p><b><i>Downloadable files:</i></b> HMMER table and Stockholm format MSA are available for download. These are not altered from the direct output from the HMMER run.</p>

    <strong>Team members who implemented App in KBase:</strong> Dylan Chivian. For questions, please <a href=”http://kbase.us/contact-us/”>contact us</a>.</p>


publications :
    -
        display-text: |
            Eddy SR. Accelerated Profile HMM Searches. PLOS Computational Biology. 2011;7: e1002195. doi:10.1371/journal.pcbi.1002195
        link: https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1002195

    -
        display-text: |
            HMMER v3.3.1 source:
        link: http://HMMER.ORG
